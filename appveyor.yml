version: 1.0.{build}
image: Visual Studio 2017
nuget:
  disable_publish_on_pr: true
build_script:
  - choco install "msbuild-sonarqube-runner" -y
  - MSBuild.SonarQube.Runner.exe begin /k:"microdocum" /d:sonar.organization="rour-github" /d:sonar.host.url="https://sonarcloud.io" /d:sonar.login="cbdf162317a340f70ceee07b9c6a21ec79dab3e1"
  - dotnet restore
  - dotnet build
  - dotnet test
  - MSBuild.SonarQube.Runner.exe end /d:sonar.login="cbdf162317a340f70ceee07b9c6a21ec79dab3e1"   
artifacts:
    - path: artifacts\**\*.*
cache:
    - '%USERPROFILE%\.nuget\packages'  
deploy:
  provider: NuGet  
  api_key:
    secure: OHher9MQYcKNN+UPFP05thonnDs8t/8kq91EYXkFLqeDxsIAD4jZZV+RmeZhLrHP
  skip_symbols: false  
  artifact: /.*\.nupkg/ 
  on:
    branch: master  